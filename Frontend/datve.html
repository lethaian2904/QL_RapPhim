<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieCyber</title>

    <!-- ANIMATE CSS  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <!-- FONT AWESOME  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- BOOTSTRAP 4  CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- FONT GOOGLE  -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,700;1,300&family=Roboto+Condensed:wght@300;400;700&family=Roboto:wght@700&family=Work+Sans:wght@300;400;700&display=swap"
        rel="stylesheet">

    <!-- VENOBOX CSS  -->
    <link rel="stylesheet" href="./css/venobox.min.css">

    <style>
        body {

            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
            background: url(./img/slide-3-video.png);
            background-position: center;
            background-size: cover;
            min-height: 100;
            width: 100%;
        }

        .containers {

            text-align: center;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(15px);
        }

        h1 {
            color: #3498db;
        }

        .controls {
            margin-bottom: 20px;
            margin-top: 150px;

        }

        .controls label {
            display: block;
            margin-bottom: 10px;
            color: #ecf0f1;
        }

        .controls select,
        .controls input[type="datetime-local"],
        .controls select {
            padding: 10px;
            margin-bottom: 15px;
            border: 2px solid #3498db;
            border-radius: 5px;
            width: 100%;
            box-sizing: border-box;
            background-color: #2c3e50;
            color: #ecf0f1;
        }

        .seat-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            perspective: 1000px;
        }

        .seat {
            width: 50px;
            height: 50px;
            background-color: #bdc3c7;
            border: 2px solid #34495e;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease;
        }

        .seat.normal {
            background-color: #bdc3c7;
        }

        .seat.vip {
            background-color: #f39c12;
            color: #fff;
        }

        .seat.selected {
            background-color: #3498db;
            transform: scale(1.1);
        }

        button {
            margin-top: 20px;
            padding: 15px 30px;
            background-color: #3498db;
            color: #ecf0f1;
            border: none;
            cursor: pointer;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #2980b9;
        }

        #movie {
            background-color: #fff;
            color: black;
        }

        #datetime {
            background-color: #fff;
            color: black;
        }

        #ticket-type {
            background-color: #fff;
            color: black;
        }

        .mess {
            color: white;
        }
    </style>

    <!-- MAIN CSS  -->
    <link rel="stylesheet" href="./css/index.css">


</head>

<body>
    <!-- HEADER  -->
    <header class="container-md" style="width: 80%;">
        <p class="text-right text-white mb-0">
            <i class="fa-solid fa-phone"></i>
            <span class="mx-3 border-right pr-2">012.345.6789</span>
            <i class="fa fa-search"></i>
        </p>
        <nav class="navbar navbar-expand-md">
            <a class="navbar-brand" href="#"
                style="color: #fff; font-size: 50px; letter-spacing: 5px; margin-left: 50px;">
                CIW
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#movieNavBar"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon">
                    <i class="fa fa-bars"></i>
                </span>
            </button>

            <div class="collapse navbar-collapse" id="movieNavBar">
                <ul class="navbar-nav ml-auto" style="">
                    <li class="nav-item active line">
                        <a class="nav-link" href="#">TRANG CHỦ</a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">RẠP PHIM </a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">LỊCH CHIẾU</a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">ƯU ĐÃI</a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">THÀNH VIÊN</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <header id="headerFixed">
        <nav class="navbar navbar-expand-lg container">
            <a class="navbar-brand" href="#"
                style="color: #fff; font-size: 50px; letter-spacing: 5px; margin-left: 150px;">
                CIW
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#movieNavBar"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon">
                </span>
            </button>

            <div class="collapse navbar-collapse" id="movieNavBar">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active line">
                        <a class="nav-link" href="#">TRANG CHỦ <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">RẠP PHIM</a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">LỊCH CHIẾU</a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">ƯU ĐÃI</a>
                    </li>
                    <li class="nav-item line">
                        <a class="nav-link" href="#">THÀNH VIÊN</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- CAROUSEL  -->
    <section class="movieCarousel">
        <!-- data-ride="carousel" -->
        <div id="carouselMovie" class="carousel slide">
            <ol class="container carousel-indicators">
                <li data-target="#carouselMovie" data-slide-to="0" class="active"></li>
                <li data-target="#carouselMovie" data-slide-to="1"></li>
                <li data-target="#carouselMovie" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="d-block w-100" src="./img/hero-1.jpg" alt="First slide">
                    <div class="movieCarousel__overlay">
                    </div>
                    <div class="container carousel-caption d-none d-md-block">
                        <div class="col-9">
                            <p class="animate__animated animate__fadeInDown">ACTION, ADVENTURE, FANTASY</p>
                            <h2 class="animate__animated animate__fadeInDown">End of the World: Part I</h2>
                            <p class="animate__animated animate__fadeInUp">Lorem ipsum dolor sit amet consectetur
                                adipisicing elit. Alias voluptas tempora esse
                                maiores quasi eius, laudantium ratione earum dicta corrupti.</p>
                            <div class="movieCarousel__trailer animate__animated animate__fadeInUp">
                                <span>PG</span>
                                <button>
                                    <span>
                                        <i class="fa fa-play"></i>
                                        PLAY TRAILER
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" src="./img/hero-2.jpg" alt="Second slide">
                    <div class="movieCarousel__overlay">
                    </div>
                    <div class="container carousel-caption d-none d-md-block">
                        <div class="col-9">
                            <p class="animate__animated animate__fadeInDown">ACTION, ADVENTURE, FANTASY</p>
                            <h2 class="animate__animated animate__fadeInDown">End of the World: Part II</h2>
                            <p class="animate__animated animate__fadeInUp">Lorem ipsum dolor sit amet consectetur
                                adipisicing elit. Alias voluptas tempora esse
                                maiores
                                quasi eius, laudantium ratione earum dicta corrupti.</p>
                            <div class="movieCarousel__trailer animate__animated animate__fadeInUp">
                                <span>PG</span>
                                <button>
                                    <span>
                                        <i class="fa fa-play"></i>
                                        PLAY TRAILER
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" src="./img/hero-3.jpg" alt="Third slide">
                    <div class="movieCarousel__overlay">
                    </div>
                    <div class="container carousel-caption d-none d-md-block">
                        <div class="col-9">
                            <p class="animate__animated animate__fadeInDown">ACTION, ADVENTURE, FANTASY</p>
                            <h2 class="animate__animated animate__fadeInDown">End of the World: Part III</h2>
                            <p class="animate__animated animate__fadeInUp">Lorem ipsum dolor sit amet consectetur
                                adipisicing elit. Alias voluptas tempora esse
                                maiores
                                quasi eius, laudantium ratione earum dicta corrupti.</p>
                            <div class="movieCarousel__trailer animate__animated animate__fadeInUp">
                                <span>PG</span>
                                <button>
                                    <span>
                                        <i class="fa fa-play"></i>
                                        PLAY TRAILER
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="containers">
        <h1 style="color: white;">Chọn ghế xem phim</h1>
        <div id="seats" class="seat-container"></div>
        <p id="message" class="mess"></p>
        <p id="total-price" class="mess">Tổng giá: $0</p>

        <!-- <label for="ticket-type" class="controls">
            Chọn loại vé:
            <select id="ticket-type">
                <option value="normal">Vé thường - $10</option>
                <option value="vip">Vé VIP - $15</option>
            </select>
        </label> -->

        <button onclick="bookSeats()">Tiếp theo</button>
    </div>



    <!-- FOOTER  -->
    <footer>
        <div class="container">
            <div class="row section">
                <div class="col-3">
                    <h3>GET IN TOUCH</h3>
                    <ul>
                        <li><a href="#">FAQs</a></li>
                        <li><a href="#">Give us feedback</a></li>
                        <li><a href="#">Contact us</a></li>
                    </ul>
                </div>
                <div class="col-3">
                    <h3>ABOUT MOVIE STAR</h3>
                    <ul>
                        <li><a href="#">About us</a></li>
                        <li><a href="#">Find us</a></li>
                        <li><a href="#">Schedule</a></li>
                        <li><a href="#">News</a></li>
                    </ul>
                </div>
                <div class="col-3">
                    <h3>LEGAL STUFF</h3>
                    <ul>
                        <li><a href="#">Terms & Conditions</a></li>
                        <li><a href="#">Privacy policy</a></li>
                        <li><a href="#">Cookie policy</a></li>
                    </ul>
                </div>
                <div class="col-3">
                    <h3>CONNECT WITH US</h3>
                    <ul>
                        <li><a href="#"><i class="fab fa-facebook-f"></i> Facebook</a></li>
                        <li><a href="#"><i class="fab fa-twitter"></i> Twitter/a></li>
                        <li><a href="#"><i class="fab fa-google-plus-g"></i> Google +</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer__copyright">
                <p>2020 © Movie Cyber / Cybersoft</p>
            </div>
        </div>
    </footer>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const seatContainer = document.getElementById("seats");
            const message = document.getElementById("message");
            const totalPrice = document.getElementById("total-price");

            // Gọi API để lấy thông tin danh sách ghế
            fetch("http://localhost:8080/api/showtimes/1/available_seats")
                .then(response => response.json())
                .then(seatsData => {
                    // Tạo danh sách ghế từ dữ liệu API
                    createSeats(seatsData);
                })
                .catch(error => console.error("Lỗi khi lấy dữ liệu ghế:", error));

            // Hàm tạo danh sách ghế từ dữ liệu API
            function createSeats(seatsData) {
                seatsData.forEach(seatData => {
                    const seat = document.createElement("div");
                    seat.classList.add("seat");
                    seat.classList.add(getSeatType(seatData.rowNumber, seatData.seatNumber));
                    seat.dataset.row = seatData.rowNumber;
                    seat.dataset.seat = seatData.seatNumber;

                    // Kiểm tra xem ghế có sẵn hay không
                    if (seatData.isAvailable) {
                        seat.addEventListener("click", function () {
                            if (!this.classList.contains("occupied")) {
                                this.classList.toggle("selected");
                                updateMessage();
                                updateTotalPrice();
                            }
                        });
                    } else {
                        seat.classList.add("occupied");
                    }

                    seatContainer.appendChild(seat);
                });
            }

            // Hàm cập nhật thông báo số ghế đã chọn
            function updateMessage() {
                const selectedSeats = document.querySelectorAll(".seat.selected");
                message.innerText = `Bạn đã chọn ${selectedSeats.length} ghế`;
            }

            // Hàm cập nhật tổng giá vé
            function updateTotalPrice() {
                const selectedSeats = document.querySelectorAll('.seat.selected');

                // Assume you have the cinema ID stored in a variable
                const urlParams = new URLSearchParams(window.location.search);
                const cinemaId = urlParams.get('cinemaId');

                // Kiểm tra xem có ID không
                if (cinemaId) {
                    // Gọi API để lấy thông tin loại vé
                    fetch("http://localhost:8080/api/ticket_types")
                        .then(response => response.json())
                        .then(ticketTypes => {
                            // Tìm loại vé có name là 've' và cinemaId tương ứng
                            const veTicketType = ticketTypes.find(ticketType => ticketType.name === 've' && ticketType.cinema.id === parseInt(cinemaId));

                            // Kiểm tra xem có loại vé 've' không
                            if (veTicketType) {
                                // Lấy giá vé
                                const veTicketPrice = veTicketType.price;

                                // Tính toán tổng giá vé
                                const numberOfSelectedSeats = selectedSeats.length;
                                const totalPriceValue = veTicketPrice * numberOfSelectedSeats;

                                // Hiển thị tổng giá vé
                                totalPrice.textContent = `Tổng giá: $${totalPriceValue}`;
                            } else {
                                console.error("Không tìm thấy loại vé 've' cho rạp chiếu phim có ID là", cinemaId);
                            }
                        })
                        .catch(error => console.error("Lỗi khi lấy dữ liệu loại vé:", error));
                } else {
                    console.error("Không tìm thấy ID Rạp trong URL");
                }
            }

            // Hàm giả lập khi nhấn nút "Tiếp theo"
            window.bookSeats = function () {
                const selectedSeats = document.querySelectorAll('.seat.selected');
                const selectedSeatNumbers = Array.from(selectedSeats).map(seat => seat.dataset.row + '-' + seat.dataset.seat);
                alert(`Bạn đã chọn các ghế: ${selectedSeatNumbers.join(', ')}`);
                // Thực hiện các bước tiếp theo, ví dụ: chuyển đến trang thanh toán
            };
            // window.location.href = "/Frontend/order.html?cinemaId=${cinemaId}";
            // Hàm giả lập loại ghế dựa trên hàng và số ghế
            function getSeatType(row, seatNumber) {
                // Giả sử có một số điều kiện để xác định loại ghế
                // Trong ví dụ này, nếu số ghế là chẵn, là ghế VIP
                return seatNumber % 2 === 0 ? 'vip' : 'normal';
            }

        });
    </script>



    <!-- Thư viện hỗ trợ  -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

    <!-- BOOTSTRAP 4 JS  -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <!-- VENOBOX JS-->
    <script src="./js/venobox.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.venobox').venobox();
        });
    </script>

    <!-- MAIN JS  -->
    <script>
        window.onscroll = function () {
            // Code tạo hiệu ứng xuất hiện thanh màu đen khi scroll
            if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
                // 
                document.getElementById("headerFixed").style.transform = "translate(-50%,0)";
            }
            else {
                document.getElementById("headerFixed").style.transform = "translate(-50%,-100%)";
            }
        }
    </script>
    <script src="./js/datve.js"></script>
</body>

</html>